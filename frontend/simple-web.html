<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Leaderboard</title>
</head>
<body>

<h2>Leaderboard</h2>
<table border="1" cellpadding="6">
  <thead>
    <tr>
      <th>Rank</th>
      <th>Username</th>
      <th>Rating</th>
    </tr>
  </thead>
  <tbody id="leaderboard"></tbody>
</table>

<h3>Search User</h3>
<input id="q" placeholder="rahul" />

<table border="1" cellpadding="6">
  <thead>
    <tr>
      <th>Rank</th>
      <th>Username</th>
      <th>Rating</th>
    </tr>
  </thead>
  <tbody id="results"></tbody>
</table>

<script>
const API = "http://127.0.0.1:9090";


fetch(API + "/leaderboard?limit=10")
  .then(res => res.json())
  .then(data => {
    const tbody = document.getElementById("leaderboard");
    tbody.innerHTML = "";
    data.forEach(u => {
      tbody.innerHTML +=
        `<tr>
          <td>${u.rank}</td>
          <td>${u.username}</td>
          <td>${u.rating}</td>
        </tr>`;
    });
  })
  .catch(err => alert("Leaderboard error: " + err));

document.getElementById("q").addEventListener("input", e => {
  fetch(API + "/search?q=" + e.target.value)
    .then(res => res.json())
    .then(data => {
      const tbody = document.getElementById("results");
      tbody.innerHTML = "";
      data.forEach(u => {
        tbody.innerHTML +=
          `<tr>
            <td>${u.rank}</td>
            <td>${u.username}</td>
            <td>${u.rating}</td>
          </tr>`;
      });
    })
    .catch(err => alert("Search error: " + err));
});
</script>

</body>
</html>
